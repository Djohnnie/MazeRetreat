using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using MazeRetreat.Api.Extensions;

namespace MazeRetreat.Api.Logic
{
    public class RenderingLogic
    {
        private readonly String _border = "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUFBRDRFNjA1RURDMTFFNjkxQThEQUIzRDFGRjQyOTIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUFBRDRFNjE1RURDMTFFNjkxQThEQUIzRDFGRjQyOTIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1QUFENEU1RTVFREMxMUU2OTFBOERBQjNEMUZGNDI5MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1QUFENEU1RjVFREMxMUU2OTFBOERBQjNEMUZGNDI5MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pn8auUcAAADPSURBVHja7JlLCoAwDAX9Igiew2t5Qi8nCCKKO+mmUGmiCU5WrooD81KeluM8FZ6nKpwPAF9P4/Glj2VDIQBMZ6Dq2/v5XHfx8+uhQyEA1DMQ7trQuZTR8D6WKxQCQCsDMe9DF7W9TzkfhQCw3gdy7hMUAsBiBp7uew3vUQiAtzOg3XFRCADrGbDmPQoBQB9AIQD8ZIA+AMBfMvB030t1DBQCQDIDOV5K/UcLs5RyPgoBIJkBy90XhQDw2ge0+wMKAeApAxrfiFAIgMy5BBgAWcs64FTfoyoAAAAASUVORK5CYII=";
        private readonly String _road = "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUFCMjMxOEU1RURDMTFFNjkxQThEQUIzRDFGRjQyOTIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUFCMjMxOEY1RURDMTFFNjkxQThEQUIzRDFGRjQyOTIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1QUFENEU2NjVFREMxMUU2OTFBOERBQjNEMUZGNDI5MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1QUFENEU2NzVFREMxMUU2OTFBOERBQjNEMUZGNDI5MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PhLx5cMAAADPSURBVHja7Jk7CoBADAVVRPzd/ywexiNY+sPKTrYRVjbRBCeV1eLAvCxP82kcMs9TZM4HgK+n9PjS87KiEACmM9DU1fW87Yf4+X3XohAA6hkId23oXMxoeH+XKxQCQCsDd96HLmp7H3M+CgFgvQ+k3CcoBIDFDDzd9xreoxAAb2dAu+OiEADWM2DNexQCgD6AQgD4yQB9AIC/ZODpvpfqGCgEgGQGUryU+o8WZinmfBQCQDIDlrsvCgHgtQ9o9wcUAsBTBjS+EaEQAIlzCjAAETE8OS0fHPEAAAAASUVORK5CYII=";
        private readonly String _start = "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";
        private readonly String _finish = "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";
        private readonly String _teleport1 = "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5QjJDQzFDOEUxQTkxMUUzQTU3RTk1MkE1Njg5NkVCRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5QjJDQzFDOUUxQTkxMUUzQTU3RTk1MkE1Njg5NkVCRCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjlCMkNDMUM2RTFBOTExRTNBNTdFOTUyQTU2ODk2RUJEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjlCMkNDMUM3RTFBOTExRTNBNTdFOTUyQTU2ODk2RUJEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+PhO/iQAABLVJREFUeNrsmklOW0EQhttgZpAtRgkksITENtwgLGBhWMQ3CDeIj+CcID4CuYGzsEGChXMDVkjsMBJiEsgW8+jU33plNZZfu5/dD1DcJbUcOy/9qr4aurs6kWq1KjpZukSHiwPgADgADoAD4AA4AA6AA+AAOAAOgAPgAHSgRE0eikQigSfe3t6OPT09LdK/TdDXxOvra8L7s8n7ivisVqtFGgdra2ulVowzafZEjB4yBFAoFL7Ss0s0JwaMj9vwEs1VBhQaOQJZNAXyLgDg6efn5zQplqLnFtW/GxoakqO/v1+Ovr4+I4MrlUrt8/7+Xjw8PNQ/kgOMZDL5+0MBwOP0sYEQx/fu7m4xMzMjYrGYiMfj1vL0+vpawri4uKjB8QzcJd3Sq6urf98VgJffMDyF75OTk2Jubk56OWyhaBOnp6fi6OhIjYxiT09PamVlpRI6gM3Nze8U7lnkNzw+Pz8vpqamjJR/eXkxW5q6uprWHYAABAzMizpBP69TffgTGgAYT8/D82JsbEwsLCyIaDSqNVgdpgKwgICB+XUwAGJvb6+WGvTsOtcGqwDy+fw3FB58h+E6r1OEyPBsZDSMCxopFN5yAIif7O/vi7OzM/Z8CpFgDcDOzk7s8fHxAGE/Ozsr891PqDa8qdowGF5kr5qmCgbmUvXDKgIQflIqlcTh4aFMh97e3sTy8nLFyk6QFMnAeFR3nfHqkgVjBwcHxcDAQFPvNYoSMkAuoTCaUwBz4x1+At2gI3TF0mxzKyyr/fT0tDYXMSBQHsYHMdpPAA8gMGf9exoJ60hRsG4TgFznx8fHtaHPxrOyNkWdl9/VSBQdEzYBGBcu3arQrpgU0A87DXKehnnbzJBbOZxZAaDLPa7Od3d3gdb8IMbTSvTmXUF1DBUA8pNDFBBY2XYFewrMh8HG61JBVx9a7gfUV3q/PMeSB8PVwUtakPxFGvG71Ghqtg/w23xZA8BrPQz1M4iNhfG8oWHv8WZIl8ONts0mEPG+oN5vCQCHuG65g6KABE9CKd7RBTkTYA4MeFwHjN/Rasq1vGaxhxGWfhseKM6gGABy2sRw08KIiGxn5Wlr0YYCt7e3tf2+7uSG323sEbg+wOvNYFpbBdB5wWe5XPYFgQJ0c3NTiwybwkbD23gH3uVnPOvIOluJAArxHJqcl5eXTVtdnIvwOFJDDekgoQ0D2fAgnua+AHS2BoAUQBMkTZPHQdik3xe06NkQ6AYn4ThMxTNrLQXQhiai8niJ8zby/rMJdIJunmTq+4NWWmKFQuEXIoG7v2iLfQY5Pj4WJycnrGsmmUz+DK0pms/nf9B3GV5oPgCEab/ftlxdXUnD0Tav7weGBgCytbX1hepCjs/cw8PDYnR0VAIJ8zjM23EUuvPz89oOk+SA7EirHeFQAUCUG6E0X4EhNSYmJiSQkZERq0bz5QgGF1YUO6pNWYKebZTz73Y36N0QZWgsqWcCbIcxAARiCgWhzYcpGKx4mgX3hBsffjVWL0gNtKS9flzCZuh7Gxssx7lPdTnqJ8r1uLwppp8WA0Apeu/F9TiuvXZNl7VQAPzP4v6LjAPgADgADoAD4AA4AA6AA+AAOAAOQCfKPwEGAMupHbe8aaOuAAAAAElFTkSuQmCC";
        private readonly String _teleport2 = "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCQTM5M0RFNEUxQTkxMUUzOEUzNkIzMjE2NkVENDExNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCQTM5M0RFNUUxQTkxMUUzOEUzNkIzMjE2NkVENDExNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkJBMzkzREUyRTFBOTExRTM4RTM2QjMyMTY2RUQ0MTE3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkJBMzkzREUzRTFBOTExRTM4RTM2QjMyMTY2RUQ0MTE3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+0EKjYQAABS9JREFUeNrsms1uI0UQx6vnw147IcnGuwIkkAyHvXBYvwF7gAMLEn4DIhTgiB8hjxCOfCq8gTkQDruHcOcQCYnDSrBBrIQgGzvx5sNfM0X/e6bXzsaetO2ZJCJdUmtiZ9Jd9euqruruCGam6ywOXXOxACwAC8ACsAAsAAvAArAALAALwAKwACyAayieyUtCiIk7/vKdm4u+71ZCh8uCRZlJlElw2Wg8pi39DEV/Z3Vz/89pjDM57BFGLxkC+O69W2+zoHto8mNF/uVSOvPE+wQoguvEwZYpkAsBgJn2cm4tJFGVr1WGf7fgy5YjKnqCCh6eZubutfWT6bhPdBKcsawOGKs/7n1/qQAw46EQGyRIuba0k95cEFS6QbKJ1OL0oMsKyj/H8tkZNpC2Xebaxz89/flCAWDW3ZwrDRdVfH5tjujOklAznbX0Qqa/Doket3jIM3gr6ATVzx42DzIH8M37pY/kN+uIb9j71rKg1+fNDO+HUimD91zZnSPOB/G4RfSHBNHnaJ2Qtqx8srn3Q2YAIuOdDfz8ckGucrcE+QmawuBuCGWjZiq+E0Hw5DPnJMMAiF/+HQ6NcEWvDakC+Pp+6UMhnDo+3y0lz3oguzzqRcaf6ocioyb1lBsuqUXUTQCx/TSkJ0d65sMqPCE1AF+9u7zo5t0duP2dRaHifZy0g8h4HprNvDuYVbM4jxr6CnkAb86PYIyTR/tMjw5YhYNcE8qfPmgcpFIJOnl3DcaX8pRo/DNp+GFsPIy9Kd9fzEVKu2KyEEDKXJZ/P+9HIYA+0TfGGCfQDTqq9Umm5tRKYVnJqdX+jYXxVnSCqEHmvMh4N4WkAHgAoWuI4XFGidZRVp4r6e0F4jz/SjHZ9bXxBY9SFwCY806PNUqe6xjrfGGboX684OXcDDcuGWzdUutSlwphhpfNOpU64pIAJMVeIZ75VnfgDWkbf9IfrAvT6DgzgG6CYYh7rN6saveBsrMKagr0h8ax8X6C1u0JAXiTekAuzuujBCkPuze0o7jhfQ3HVBBGgN0NTkOfP6cOQJrshRkC0IMgBscZVIyNBYReXAp3u6dL3OTS9qwRubguSFoE4XGTzv5UADiO82JCuoOh8AbMJLzmJK7olHFGWXewD4C3JQFDvzD8eMqQmypjAwLcG7MLtxxX8EDxQgxKAwj4/CrQNFzQHyrDWTLPTCULFGh2BvV+0s4N3+dTqBH0+gCXD1JIuUascfKCZ6PNY0FgbQAMHftpig6lZ/EYGGuc8VpHrXMqHuAQ12VtXdmVnS8nHHVhaB2LmHEv3tNrl57EtWGgNnySmW52+LnOqQFg6m/IV2vNjlhqnAPhlKtycu2QtkC33XZ0OtTvBuuphUB0DM1qe/l7i+V+/+r9cyV0gm7RjIm1F88HZ64EcczExOtwx9+akvTJ1YHw5JDp1warUBHMa6ubu18Y72EmPhS9f/tzmaiVe2HPX35JyNVdXIrhLRljML7VO3semMmhqJZvP1i6y6Ff13tuXIDcLggFxHOyhdGXiwsywd/HPCh+mHaYwtrwiXCmACD6RogF1fQVGBzh1aJQt0ELOZGq0ag+scI3OsNZgfcF0zoWvFExf2F3g+qGyCGcG97T3+VRv/s4xYmAKE8xhALX1kdfjQ6PKHN5S7aNS78ae1EQGhR6VXUeZ3gkZVx+y8JGaiHTca9+pS5Hx4m+Hle3xdFNccUcCmY4uh5H6/WCbdO0lgmA/7PYf5GxACwAC8ACsAAsAAvAArAALAALwAK4jvKfAAMAjjCW+HRrRBcAAAAASUVORK5CYII=";
        private readonly String _teleport3 = "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBRjIzMEY2N0UxQTkxMUUzODZGM0Q5NzY2RkJFMzVEQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBRjIzMEY2OEUxQTkxMUUzODZGM0Q5NzY2RkJFMzVEQSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkFGMjMwRjY1RTFBOTExRTM4NkYzRDk3NjZGQkUzNURBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkFGMjMwRjY2RTFBOTExRTM4NkYzRDk3NjZGQkUzNURBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+mpQPcAAABalJREFUeNrsWltPK1UUXnPrlV4AAcUcT40aHzSRf2BJ9Fn+gWAM+GZ/Av4CeQSSI/gP8Fnjqf+ABxMfDJFzPMEIciv0Mp1px/Xt6fT0YGeYwrQQ2SvZmRmY2Xutb1332lUcx6GHTCo9cJIASAAkABIACYAEQAIgAZAASAAkABIACYAE4AGSHuYlRVEGnnj5k42c1VLmyHEK/HWByCk44hpiPVLKuDqKUlYVdf/Jz18+u4lwYZo9SqiXQgKwNL/5MU9YdMgp8uMcf5WPQkvM4RnPVXZI2VFVrRwWkJEAAE3bNpVY6AV+a673f+lkhtKpDMXjSYrHEpTgaxg6vzjtXE/INOtkNhtXX9kBGFvlle/vFABonJz2ttIxbU3TaXbmMeUy4zwmIvPTy1qFKgzK8dmhuPZYxi4pamnr6fIvIwXA1bqzzbcLeJ6enKVHs++E1vBtyLYtOjw+oIO/n3UtgyUoG7qysPnTyvnQAVgqbnzOU6/Bv6Hxtx+9TzOvvRmS+VYopjRNI1VVrgXi4PC5AKLVskWc4Oi5uPX0qx+GBgCEV0honibyU/Re4UPSdSNQYKtpk23Z4j50atI10jA0lYyYEQgGgPhtb7frGhwbFr3YECkAS/PrnykO7eD53cIHgVpvtdpUrzbIYsFfncfV7nXUasFSXj7HEzExAIgf/f7Hr8I13PRJC7CEyABY+XQzZ9nOPswevv4WDz8yG02q1xpdAaDNWNwg3dADBeglAGdbLWqaTWq3nS54yVRCAOFHzw/26E8ecAeOCYWNH5fPI6kEOeCtQvgsR/cg4auXdapVXeEhbDY/Rplc+lrtXSWDwUqm4pQbz1AqnRAugDkxN9bwI/AGHsErUnNkpbDTifaz049932k2LdaYJe7BPIQfRGg/AngAIpGMu+vwGljLjzweuS5ZjAwAL89Pjk/7m3692RXeYzZKwrwYvWv1I49HJWTZHdlmCIFLmG/MGFoNgMxwb3eDXqpst9vDK4IsF2RVU+8GgCDf86Jz9aI2UM4PS8gMZsMU98gqN+Hx1gCgqPEj+D1SHqL1ZaVKjboZkWu16eK8ynPWxNwAGlniulgUaT+giy5HYCOmU8zHz5Hy6jVTCI8rBpiNJ4OZvkrI/RZrEoD3FlNIiUF1ANLkoNanD6qRGudhJaP4CoRIrRsaNVh4UQpbL4XwStyg7XW/shlrJVKuhfkRQEcRNpSO0Ks7LNfPYfJ+6Q4MGzldaBLVHBjDPQQLoyGvZBbWFo8F7gUwL+a/qcvpN/kIIMC8YaKpsaRvwQPGPaBcAGxq2cFZAtYT1l1gWbBIr1weGQC9u73K2WW33g/aueHvInbEbhcUvfgArSNAjqQpis4L2l2V6gll0xN9gcBQeBMUT8QH0mJYoWE9Iiiy8EH7N/DY7RZF1hUmhbfBztz55VFfAHpdQ/hi3dU4/BhBD4B4sSGsabdZu562B9H0Re20h+eoAFC17XbbLvHkeT8r6Kc1/sbNAHUaCYE3KMndDtNaZIWQ24ZWxPby4J89aphVum8EnsBbx/xXr/YHI2mJfVFc/5YvJVXV6PWJAuUzU/dC+KPTF3R09sLjdvW78so3Q2uKLhbXv2azEeaVSY3TDAMRM+J3Ini1XhGC1xqV//QDhwaAsIT59Y/4sx1vz51KZCk/NiUAQad4mIQOMALdceUvMps1z+T3OeqVejvCQwUA1HMiVPKOwOAak9k3BCDpZDZSoausZQh+UTvh4NryBD/jaL+mc8Dr5/MjOxvsnBChb1jslsM6V4CxFI+0AAQUFhSYtmWbYlRYYE/TPXVJmbnavvOjsasE1yBHWUA/LmxLKnT5zYUNj21N1Xfu1eGoH3nH4zgtRhHluKfFhZDCljvFTBlH5Ibm7IZNa0MB4P9M8icyEgAJgARAAiABkABIACQAEgAJgARAAvAQ6V8BBgCEGweW8Y/uhgAAAABJRU5ErkJggg==";
        private readonly String _teleport4 = "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3N0RERDAwNEUxQTkxMUUzOUZGOEI0NDVCOTk1OEFCNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3N0RERDAwNUUxQTkxMUUzOUZGOEI0NDVCOTk1OEFCNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3REREMDAyRTFBOTExRTM5RkY4QjQ0NUI5OTU4QUI3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjc3REREMDAzRTFBOTExRTM5RkY4QjQ0NUI5OTU4QUI3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+HD1q2gAABYNJREFUeNrsWs1OW0cUPjPXmN8EQkggClJdKWortVLpJtvyBuUNyqooq3rRNF3SXUgXZVOl6Yq+AX0DV+qmOxapFHVTp0pVp6HBEP4M9pyeb8bXGPC9XJN7CSoz0mBsX2bO+c7fd2ZQzEwXeWi64MMD4AHwAHgAPAAeAA+AB8AD4AHwAHgAPAAegAs4ckkeUkp1vfCVz+4P9wZ6iogLxLpgX4kKyf5aldwLl5TW5b+/++LpaZRLctijEj2UEICJOw8+JlbTsvW0YpoiRSOpmImpKj9KrGlZ6aCUFJAzAcBaWgdFWWhGFJ469OXgCKkhmX2DdhJmEsGr/7ReeXeLqLZ9VLNlgFF5eO/HNwqAszgvKVLOtYMe0pPvkBq5TlpmWoM318gAjNW/iNdftHvGigBRrDz88uczBQBW71NqSb6Ysd+PFygofOCsnPHg+h6Zyh9knv3e8gzRoFQzZmbth6/WMwdg4s7Cp8qoRRvfYvHg1kekJ95OJnxjH1Kd/GCQkz31yUAICBYIuy5VDanZ54/u/pQZAFZ5Fsvjs6s3KXjvNqlcPl7h/T2iOuZ+F7Wpx4JgZ09vLBgAovH4l1ZosOLZMDekCsD43DefaMXL1kDv3o61OpsG0c4rp/zhhZxSJ41G/bCn9PbLHCCpAJF/Un/yK/Hzsv3dsJqBJ6QGwOjcgsS8LsPt9Vvv23iPVH5vR5TfPFAA1sz3yWs+VoGjVrUeg7WMOQCvf4hUvj8at/JjMk9/s+Gwy6bw8tG99VSYoCS8eSivhq/FK7+9QbT9yikPS1++KmXwihU6qfJWV4CF0nl5jGjgkkip3Zqytt0jKnUgEYuMkBWlOTUqzIpstkeJi3xmvyYW23VvYKlLo10pHQkGwAMQYYWRPexeUQq1ZDSzqQEQ1nk9Nhn9UEhWoLzEa9rDllhZ+9BenRRqytjiJmfWDCFxYUjWzmwEudSXTA+AkCugAmQ1wlKaQmidCoC42KPQ7bfWXf3PgAG2XB9V5TQyvrYHxCxu4x4lD9l6s0ocE6ddKS4ehV4Aa9q1hRPEkS/qct/uggoZGMwsIs5R8mz3hilcgMEHevKOxMQJfayJMQ5sO9vIlJTEOB7AIF/1/QwBwJA6zIPDkQohWzM8ASDUm1RYJrdT3Die34k2A0TwAuk9IpWH5Ws72ZwIHTGPi3MIFFHuLDhDeWdJcAMIB0YHxZJYKKTM8DSJ99heAHtAcQCe1ZFYRxDg4nDRgcuRhMcKDpBkWkGhfFguYxqhpOFiEyOYYUiXzwyA9rK08a9zeWTmmM7Nfg6LviZPaOUHWP0kMFMDgGkFx11GWk4Nrt0JCEwlXtGsBt0kvURK23zSTIwxDZwJT4wgc1oAsFLLiniKX1aIOgHQHhrNWGQ0MLan73HJL8wNSV0bhMo0rd2FpXl9tSVzagCoQC1RnYu8sToS6QXHTCHCm71DZSzr/0iEbLxWse1wjRuLqREhHEOzZttemj+fuHp7zgZkgmxWRqL5o+eDqRyJ3Zhb+FbeFEnnSN+8RXr0xrlQ3h6SNk+DmNR85fu7X2d2KDo+9+Bzrci6F/p0ABHHzjK1Oo7LK2Xireqx88DMAMC4Pnf/Q20To+u5FS5ARidIDY/FsrVUlJZGC4nOvHgmCXezaXUuM+ti+4lwpgBgtN0IFVtXYAiNa5PuNkj6glSVRoMlitssb+phVq1Ktl+smcZip5g/s7tBd0NE8/LU9AF/FwqL0yHMoZFWs5TUtRkUWqaBwk1Lt1WTkki+9Mavxo4OFxrBDM7jkh5JJXcDWpHsvqRzevlcXY5Gjdb1OKtpxWaKhUkmBcVa2O0MS5dqDbOStKxlAsD/efh/kfEAeAA8AB4AD4AHwAPgAfAAeAA8AB6Aizj+E2AAf+HDHroIWHQAAAAASUVORK5CYII=";
        private readonly String _teleport5 = "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5RTFDMjMyM0UxQTYxMUUzOTk5N0NDNkM5MjRBRUI3RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5RTFDMjMyNEUxQTYxMUUzOTk5N0NDNkM5MjRBRUI3RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjlFMUMyMzIxRTFBNjExRTM5OTk3Q0M2QzkyNEFFQjdEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjlFMUMyMzIyRTFBNjExRTM5OTk3Q0M2QzkyNEFFQjdEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+4/jozgAABPxJREFUeNrsWk1PE0EYfttuW0FUBBIwUQPxI5FE4eJFD/oP7EUvJsI/sDc9GEFPepKfUPWml/oLrAdvxuDFbyMqiZgAASy0tFvq++x02gLtdradLUTmTSbbpdvZ93nez5khUCwWaS9LkPa4GAIMAYYAQ4AhwBBgCDAEGAIMAYYAQ4AhwBCwB8VSeSgQCHie+NkDOpTN0WixSIN8Oyivau+jlLyGgjRz/Q79aAacymZPQOkhRQKe3KdLPN1lDL4d5Z9167ASz7fElxTPl7RClFIlpC0EwNKZdYrzNDF+bLT6u8MHiXp4dHUQ7efR1akG+M+CuM7xNZ0hWs1sIyQJMsYm6PGOEgCLb2xQgr92XDvMATU8RNTfSzTQqy9OF5eZjEWiX3NMzuImIqaDQYrfuEuv2koArL6WdYDHcH/iKNHIKXULtyK5PNHXWaIP3yuewRBSnfsodu02LftOwON7NMY/mUJ8w+Lnh4lOHlNTvlBgpRSe48RHjdIOiAAJ73nkbZEn+DfjHBYvfCMA4PmSwOdj/UQXR4giYXfAeR42j8KGupVBgBwg2Y0MEPHyzabQGJe5QSsBDP4Kf0zi/sI5d6tzXqBMTgCvBa6hp2whK8IkRJnooMtvX78j+jZbvo3BE7QR8PxhADE/A7dHrI+cdrcIwFcDBgAuX64AqsUueU1OuHZZOiLuHvfuM48vIhw4JwxevVVc1tIJMvhJgO/vcQe/tl4BD7AHOkQJjITVwTvdGZO1j8Ee7BSgZQhgbryjnkA36AhdUZp1tsJOtj8zVP8BJCIMCJQH+KCGRhvkgYhoePt7aonUkb1gXBsBss4fH6j/zHq+Aj4a1l/+MC9G9btqidRR6ty2xZBMXOGQfz1AyIelm7YpZZxu+HjYLKtKMLhDBLjFnnT71ayo/36Al64fsZrTsXUCCu4ESBdNZ93j1Iugp3AWRNkKeCvUOBdp3Q/YlOlDojurJSh52ZxQAlcMKAtyLA+5AbXfeVdhczPVqA/g0uep4/RMgKz1+wP1ASFT4zuAhzJ2FQjZ3rq1trXaZqcvgIc1sHzO9u5hVjNuCXd0K3dQGN4AS0IpKIfPAKZqIbkOiDRYC2BezN9syFnNxiYsDDftjNbPylAcJGFAUZVFEchTDRfMB49s5d+crFYSFMD8zVT6fbeVG/6O71vtkWR+WLdFgmxLGcTOC66/5+sTgT59ZU14hq25DErQsDbegXfVAy91lDpr8QDsv2GT8+cc0ZE+92dlPMLiMulJl/bi2gCIpipf8GZpSUBJZz0EsOIJtkB8bp668YJGJEiryQqgqydQAY99w9JyeEpbCGAbmhl1lpdvPxItp2nXCXSCbiXrT27dH9SyJZaYpEcgwmK/OXvSfXXYTvk4Q/Rppnw7OTZB93zZEyztC97ki+NeA32CCHa3HZH5JQF+YWn7fqBvBECe3qcRzvxJuebu7RbegNwQtvwFjWqAWMf+30q6nG+wXRev3hH2lQBI1YlQXB6BITRwRtDXLYZO0LA2gGPYdhk4tsKnOqI0VSvm23Y2WDohwr7h5fLChcPiUJcYkgxVUgB2LSsGAK+kt1UYnBMmdvxobKsgNLh2x7Afp7ol5aEZmgZoLsnJXXU4Wk+qjsdxWoxD01FVUmDhUjmDpVO88JpWLWu+EPA/i/kXGUOAIcAQYAgwBBgCDAGGAEOAIcAQYAjYi/JPgAEANA5PybwJPUQAAAAASUVORK5CYII=";

        public byte[] RenderMaze(String mazeData, String solutionData)
        {
            var borderImage = PngFromBase64(_border);
            var roadImage = PngFromBase64(_road);
            var startImage = PngFromBase64(_start);
            var finishImage = PngFromBase64(_finish);
            var teleport1Image = PngFromBase64(_teleport1);
            var teleport2Image = PngFromBase64(_teleport2);
            var teleport3Image = PngFromBase64(_teleport3);
            var teleport4Image = PngFromBase64(_teleport4);
            var teleport5Image = PngFromBase64(_teleport5);

            var mazeRows = mazeData.Split(Environment.NewLine);

            var maze = new char[mazeRows[0].Length, mazeRows.Length];
            int mY = 0;
            foreach (var mazeRow in mazeRows)
            {
                int mX = 0;
                foreach (var mazeChar in mazeRow)
                {
                    maze[mX, mY] = mazeChar;
                    mX++;
                }
                mY++;
            }
            using (Bitmap bitmap = new Bitmap(maze.GetLength(1) * 64, maze.GetLength(0) * 64))
            {
                using (Graphics g = Graphics.FromImage(bitmap))
                {
                    for (int y = 0; y < maze.GetLength(0); y++)
                    {
                        for (int x = 0; x < maze.GetLength(1); x++)
                        {
                            if (maze[x, y] == '#')
                            {
                                g.DrawImageUnscaled(borderImage, 64 * x, 64 * y);
                            }
                            if (maze[x, y] == '.')
                            {
                                g.DrawImageUnscaled(roadImage, 64 * x, 64 * y);
                            }
                            if (maze[x, y] == 'S')
                            {
                                g.DrawImageUnscaled(roadImage, 64 * x, 64 * y);
                                g.DrawImageUnscaled(startImage, 64 * x, 64 * y);
                            }
                            if (maze[x, y] == 'F')
                            {
                                g.DrawImageUnscaled(roadImage, 64 * x, 64 * y);
                                g.DrawImageUnscaled(finishImage, 64 * x, 64 * y);
                            }
                            if (maze[x, y] == '1')
                            {
                                g.DrawImageUnscaled(roadImage, 64 * x, 64 * y);
                                g.DrawImageUnscaled(teleport1Image, 64 * x, 64 * y);
                            }
                            if (maze[x, y] == '2')
                            {
                                g.DrawImageUnscaled(roadImage, 64 * x, 64 * y);
                                g.DrawImageUnscaled(teleport2Image, 64 * x, 64 * y);
                            }
                            if (maze[x, y] == '3')
                            {
                                g.DrawImageUnscaled(roadImage, 64 * x, 64 * y);
                                g.DrawImageUnscaled(teleport3Image, 64 * x, 64 * y);
                            }
                            if (maze[x, y] == '4')
                            {
                                g.DrawImageUnscaled(roadImage, 64 * x, 64 * y);
                                g.DrawImageUnscaled(teleport4Image, 64 * x, 64 * y);
                            }
                            if (maze[x, y] == '5')
                            {
                                g.DrawImageUnscaled(roadImage, 64 * x, 64 * y);
                                g.DrawImageUnscaled(teleport5Image, 64 * x, 64 * y);
                            }
                        }
                    }

                    if (solutionData != null)
                    {
                        var steps = solutionData.Replace($"{mazeData.Base64Encode()}-", "").Split(";", StringSplitOptions.RemoveEmptyEntries);
                        foreach (var step in steps)
                        {
                            var parts = step.Split(":", StringSplitOptions.RemoveEmptyEntries);
                            var coords = parts[1].Split(",", StringSplitOptions.RemoveEmptyEntries);
                            var x = Convert.ToInt32(coords[0]);
                            var y = Convert.ToInt32(coords[1]);
                            using (var font = new Font(FontFamily.GenericSansSerif, 30, FontStyle.Bold, GraphicsUnit.Point))
                            {
                                using (var format = new StringFormat())
                                {
                                    format.Alignment = StringAlignment.Center;
                                    format.LineAlignment = StringAlignment.Center;
                                    g.DrawString(parts[0], font, Brushes.Red, new RectangleF(64 * x, 64 * y, 64, 64), format);
                                }
                            }
                        }
                    }
                }

                using (var stream = new MemoryStream())
                {
                    bitmap.Save(stream, ImageFormat.Png);
                    return stream.GetBuffer();
                }
            }
        }

        private Image PngFromBase64(string base64)
        {
            byte[] bytes = Convert.FromBase64String(base64);
            using (var ms = new MemoryStream(bytes, 0, bytes.Length))
            {
                Image image = Image.FromStream(ms, true);
                return image;
            }
        }
    }
}